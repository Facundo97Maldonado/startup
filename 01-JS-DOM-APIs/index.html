<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html;">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Topic 1</title>

	<link rel="stylesheet" type="text/css" href="myStylesheet.css">
</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
	<header>
		<h1>Topic 1</h1>	
	</header>
	<div>
		<button class="form-control" onmouseover="changeText(this)">
				Drag mouse over me to say hello to universe
		</button>
	</div>
	<br>
	<section class="js-fade" id="arbitraryJokes">
			Hello World!
			<ul id="list"> 
				
			</ul>
	</section>
	<br>
	<div>
		<button  class="form-control btn-xs" onclick="getRepositories()" id="jokesGenerator">
				Click me! 
		</button>
	</div>


<!--JAVASCRIPT -->
<!-- Function to change the text of a button when you drag the mouse over him -->
<script>
	function changeText(id){
		id.innerHTML = "Hello Universe!";
	}
</script>
<!-- fade in / Exercise 3-->
<script>
	let section = document.querySelector('.js-fade');

	function fadeIn(section, display){
	  section.style.opacity = -10; //time after page loads to display the content
	  section.style.display = display || "block";

	  (function fade() {
	    let val = parseFloat(section.style.opacity);
	    if (!((val += .1) > 1)) {
	      section.style.opacity = val;
	      requestAnimationFrame(fade);
	    }
	  })();
	}

	fadeIn(section);
</script>

<!-- Function to set specific content to the section when is clicked. Exercise 6-->
 <script>
	function loadXMLDoc() {
	  let xhttp = new XMLHttpRequest();
	  xhttp.onreadystatechange = function() {
	    if (this.readyState == 4 && this.status == 200) {
	      let data = JSON.parse(this.responseText);
	      console.log(data.value);
	      document.getElementById("arbitraryJokes").innerHTML =
	      		data.value.joke;
	    }
	  };
	  xhttp.open("GET", "http://api.icndb.com/jokes/random", true);
	  xhttp.send();
	}
</script>
<!-- Reusable function to perform AJAX calls. Exercise 7-->
<script>
	function randomJokes(){
 	 	let config = {  								//the config object
     		url: "http://api.icndb.com/jokes/random"
  		};
    function resolve(xhttp) {
   	   let response = JSON.parse(event.target.response);
       document.getElementById('joke').innerHTML = response.value.joke;
       if (xhttp.readyState === XMLHttpRequest.DONE){
           if (xhttp.responseText.value){
               document.getElementById("jokesGenerator").innerHTML = 
               		xhttp.responseText.value.joke;
            }
        }
    };
    function reject() { //When an error occurs
   	   //Here is the Answer to exercise 8
 	   document.getElementById("joke").style.color = "red";

    };
    eventRequestReusable(config).then(resolve,reject); //Here is where the configuration object is entered
  
    };
    function eventRequestReusable(object, resolve, reject) { //Here is it the reusable function 
   return new Promise( function (resolve, reject) {          //The promise return
	   let xhttp = new XMLHttpRequest();
	   xhttp.open('GET', object.url , true);
	   xhttp.send();
	   xhttp.onload = function () {
	     if (this.status == 200) {
	       resolve(xhttp);
	     } else {
	       reject(this.statusText);
	     }
	    };
	   xhttp.onerror = function () {
	     reject(this.statusText);
	   };
   })
  };
</script>
<!--Exercise 9 -->
<script >
	    function getRepositories() {
		  let xhttp = new XMLHttpRequest();
		  xhttp.onreadystatechange = function() {
		    if (this.readyState == 4 && this.status == 200) {
		      console.log(xhttp.responseURL);
		      document.getElementById("list").innerHTML = "";
		      let response = JSON.parse(event.target.response);
		      	for(let i = 0; i < response.items.length; i++){
		      		let listElement = document.createElement("li");
		      		let data = document.createTextNode(response.items[i].full_name);
		      		listElement.appendChild(data);
		      		document.getElementById("list").appendChild(listElement);
		      	}
		    }
		  };
		  //https://api.github.com/search/repositories?q='Javascript' This is for the exercise 9.
		  xhttp.open("GET", "https://api.github.com/search/repositories?q='Javascript'", true);
		  xhttp.send();
		}
	
</script>
</body>
</html>