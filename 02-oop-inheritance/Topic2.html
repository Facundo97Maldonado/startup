<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Topic 2</title>
</head>
<body>
	<div>
		<video src="trailer.mp4" id="FastAndFurious">
			
		</video>
	</div>
	<button id="firstEvent">First Event</button>
	<button id="secondEvent">Second Event</button>
	<br>
	<br>
	<button id="playButton">Play</button>
	<button id="pauseButton">Pause</button>
	<button id="resumeButton">Resume</button>
<script>

	class Emitter{

		constructor(){
			this.events = {};
		}
		on(event, cb){
			if(this.events[event] === undefined)
				this.events[event] = [];
			this.events[event].push(cb);
		}
		emit(eventName, data) {
		  let event = this.events[eventName];
		  if( event ) {
		    	event.forEach(fn => {
		       		fn.call(null, data);
		  		});
			}
		}
		off(event){
			if(!(this.events[event] === undefined))
				delete this.events[event];
		}

	}

	let event = new Emitter();

	function primerLog(){
		console.log("First Log");
	}
	event.on('First Event', primerLog);
	function secondLog(){
		console.log("Second Log");
	}
	event.on('Second Event', secondLog);

	let eventButton = document.getElementById("firstEvent");
	let otherButton = document.getElementById("secondEvent");
	

	eventButton.addEventListener('click', function(){
		event.emit('First Event');
	});
	otherButton.addEventListener('click', function(){
		event.emit('Second Event');
	});

	event.off('First Event');

	class movie extends Emitter{

		constructor(title, year, duration){
			super();
			this.title = title;
			this.year = year;
			this.duration = duration;
		}
		play(){
			let playButton = document.getElementById("playButton");
			function playEvent(){
				let video = document.getElementById("FastAndFurious");
				video.load();
				video.play();
			}
			FastAndFurious.on("Play", playEvent);
			
			playButton.addEventListener('click', function(){
					FastAndFurious.emit('Play');
			});
		}
		pause(){
			let pauseButton = document.getElementById("pauseButton");
			function pauseEvent(){
				let video = document.getElementById("FastAndFurious");
				video.pause();
			}
			FastAndFurious.on("Pause", pauseEvent);
			
			pauseButton.addEventListener('click', function(){
					FastAndFurious.emit('Pause');
			});
		}
		resume(){
			let resumeButton = document.getElementById("resumeButton");
			function resumeEvent(){
				let video = document.getElementById("FastAndFurious");
				video.play();
			}
			FastAndFurious.on("Resume", resumeEvent);

			resumeButton.addEventListener('click', function(){
					FastAndFurious.emit('Resume');
			});
		}
	}

	let FastAndFurious = new movie("Fast and Furious 8", "2017", "03:44");
	let Transformers = new movie("Transformers - The dark side of the moon", "2013", "02:38");
	let Terminator = new movie("Terminator III", "2010", "03:15");

	console.log(FastAndFurious);
	console.log(Transformers);
	console.log(Terminator);

	class Logger {

		log(info){
			console.log("The "+ info +" event has been emitted.");
		}
		
	}

	let logger = new Logger(event);
	FastAndFurious.on('Play', logger.log);
	FastAndFurious.on('Pause', logger.log);
	FastAndFurious.on('Resume', logger.log);
	FastAndFurious.play();
	FastAndFurious.pause();
	FastAndFurious.resume();

	let social = {

		share: function(friendName){
			console.log(friendName + " share " + this.title);
		},

		like: function(friendName){
			console.log(friendName + " like "  + this.title);
		}

	}

	FastAndFurious = Object.assign(FastAndFurious, social);
	FastAndFurious.share('Mike Blessom');
	FastAndFurious.like('Vin Diesel');

	



	

</script>
</body>
</html>