<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Topic 2</title>
</head>
<body>
	<div>
		<video src="trailer.mp4" id="FastAndFurious">
			
		</video>
	</div>
	<button id="firstEvent">First Event</button>
	<button id="secondEvent">Second Event</button>
	<br>
	<br>
	<button id="playButton">Play</button>
	<button id="pauseButton">Pause</button>
	<button id="resumeButton">Resume</button>
<script>
	class Logger {

		log(info){
			console.log("The "+ info +" event has been emitted.");
		}
		
	} 

 	class Emitter{

		constructor(){
			this.events = {};
			let logger = new Logger()
		}
		on(event, cb){
			if(this.events[event] === undefined)
				this.events[event] = [];
			this.events[event].push(cb);
		}
		emit(eventName, data) {
			let event = this.events[eventName];
			logger.log(eventName)
			if( event ) {
			    event.forEach(fn => {
			      	fn.call(null, data);
			  	});
			}
		}
		off(event){
			if(!(this.events[event] === undefined))
				delete this.events[event];
		}

	}
	let event = new Emitter();

	function firstLog(){
		console.log("First Log");
	}
	event.on('First Event', firstLog);
	function secondLog(){
		console.log("Second Log");
	}
	event.on('Second Event', secondLog);

	let eventButton = document.getElementById("firstEvent");
	let otherButton = document.getElementById("secondEvent");
		
	eventButton.addEventListener('click', function(){
		event.emit('First Event');
	});
	otherButton.addEventListener('click', function(){
		event.emit('Second Event');
	});

	event.off('First Event');

	class movie extends Emitter{

		constructor(title, year, duration){
			super();
			this.title = title;
			this.year = year;
			this.duration = duration;
			this.cast = [];
		}
		play(){
			let playButton = document.getElementById("playButton");
			function playEvent(){
				let video = document.getElementById("FastAndFurious");
				video.load();
				video.play();
			}
			FastAndFurious.on("Play", playEvent);
			
			playButton.addEventListener('click', function(){
					FastAndFurious.emit('Play');
			});
		}
		pause(){
			let pauseButton = document.getElementById("pauseButton");
			function pauseEvent(){
				let video = document.getElementById("FastAndFurious");
				video.pause();
			}
			FastAndFurious.on("Pause", pauseEvent);
			
			pauseButton.addEventListener('click', function(){
					FastAndFurious.emit('Pause');
			});
		}
		resume(){
			let resumeButton = document.getElementById("resumeButton");
			function resumeEvent(){
				let video = document.getElementById("FastAndFurious");
				video.play();
			}
			FastAndFurious.on("Resume", resumeEvent);
				resumeButton.addEventListener('click', function(){
					FastAndFurious.emit('Resume');
			});
		}
		addCast(actor){
			if (Array.isArray(actor)) {
		    	for (let i = 0; i < actor.length; i++) {
		    	this.cast.push(actor[i].name);
		   		}
		  	}
		  	else{
		  		this.cast.push(actor)
		  	}
		}
	}
	let FastAndFurious = new movie("Fast and Furious 8", "2017", "03:44");
	let Transformers = new movie("Transformers - The dark side of the moon", "2013", "02:38");
	let Terminator = new movie("Terminator III", "2010", "03:15");
	console.log(FastAndFurious);
	console.log(Transformers);
	console.log(Terminator);


	let logger = new Logger(event);
	FastAndFurious.play();
	FastAndFurious.pause();
	FastAndFurious.resume();

	let social = {

		share: function(friendName){
			console.log(friendName + " share " + this.title);
		},

		like: function(friendName){
			console.log(friendName + " like "  + this.title);
		}

	}

	FastAndFurious = Object.assign(FastAndFurious, social);
	FastAndFurious.share('Mike Blessom');
	FastAndFurious.like('Vin Diesel');

	class Actor {
		constructor(name, age){
			this.name = name;
			this.age = age;
		}
	}

	let toretto = new Actor("Vin Diesel", 46);
	let otherCast = [
		oconner = new Actor("Paul Walker", "R.I.P."),
		hobbs = new Actor("Dwayne 'The Rock' Johnson", 40),
		deckard = new Actor("Jason Statham", 43)
	];

	FastAndFurious.addCast(toretto);
	FastAndFurious.addCast(otherCast);
	console.log(FastAndFurious.cast);
 </script>
</body>
</html>